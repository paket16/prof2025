## Задание 5:

# Для обеспечения сетевого взаимодействия настройте протокол динамической маршрутизации OSPF на роутерах
    - Обеспечьте работу hello-пакетов только на туннельном интерфейсе.

В рамках настроенного ранее туннеля настроим маршрутизацию OSPF. Используем для этого пакет FRR.

Установите его на обоих роутерах

`apt install frr`

Затем перейдите в конфигурационный файл: `/etc/frr/daemons`

Там включить OSPF: `ospfd=yes`

После конфигурации перезагрузите службу FRR: `systemctl restart frr`
Далее вводим команды (Для ЕКБ): 
`vtysh`  - для входа в систему FRR

`conf t` – зайдем в терминал

`router ospf`  -  переходим в режим OSPF (ой, ну всё как в пакет трейсере)

`network 10.5.5.0/24 area 0` – указываем подсети, которые планируем опубликовать. А опубликовать надо – подсеть в туннеле, и все подсети офиса. Кроме подсети в ИНТЕРНЕТ!(скопировал, не объяснение..)
```
    network 10.15.10.0/24 area 0 
	network 10.20.10.0/24 area 0
	passive-interface default
	int tun1
	no ip ospf passive
	do wr
```

Таким образом мы выполнил настройку OSPF на RTR-EKB1(Предположительно)

## Настройка для Data

```
vtysh
conf t
router ospf
network 10.5.5.0/24 area 0
network 10.6.6.0/24 area 0
network 192.168.100.0/24 area 0
network 10.200.100.0/24 area 0
network 172.16.100.0/24 area 0
passive-interface default
int tun1
no ip osp passive
do wr
int tun2
no ip osp passive
do wr
```

`network 10.6.6.0/24 area 0` - строку вставил наугад, так как дата и ксс соединяются туннелем
10.6.6.0/24

# Настройка RTR KRR

```
vtysh
conf t
router ospf
network 10.6.6.0/24 area 0
network 10.10.100.0/24 area 0
network 10.20.100.0/24 area 0
passive-interface default
int tun1
no ip osp passive
do wr
```


tun1 - название интерфейса. использовать такое, если в скрипте vpn прописано такое название

tun 2 аналогично

Проверка

Команда – `do sh ip ospf nei` покажет соседей в протоколе OSPF

А команда – `ip r`
Покажет  маршруты, которые кстати будут получены через OSPF (обратите на это внимание)


### Вставка ответа нейронки по заданию: обеспечит аутентификацию в процессе OSPF по формату message-digest, использовать ключь TEST

Для настройки аутентификации OSPF с использованием **message-digest** (тип аутентификации MD5) и ключа **TEST**, необходимо выполнить следующие шаги в конфигурации FRR (Free Range Routing). Аутентификация message-digest обеспечивает безопасность OSPF, предотвращая несанкционированное участие в процессе маршрутизации.

### Конфигурация OSPF с аутентификацией MD5

1. **Включение аутентификации на интерфейсе:**
   На интерфейсе, где требуется аутентификация (например, `tun1`), нужно включить аутентификацию и указать тип `message-digest`.

   ```bash
   interface tun1
    ip ospf authentication message-digest
   ```

2. **Настройка ключа аутентификации:**
   Для аутентификации MD5 необходимо задать ключ и его идентификатор (key ID). Обычно key ID — это число от 1 до 255.

   ```bash
   interface tun1
    ip ospf message-digest-key 1 md5 TEST
   ```

   Здесь:
   - `1` — идентификатор ключа (key ID).
   - `md5` — тип аутентификации.
   - `TEST` — сам ключ.

3. **Проверка конфигурации:**
   После настройки убедитесь, что конфигурация применена и сохранена.

   ```bash
   do write
   do show running-config
   ```

### Пример полной конфигурации для интерфейса `tun1`:

```bash
interface tun1
 ip ospf authentication message-digest
 ip ospf message-digest-key 1 md5 TEST
 no ip ospf passive
```

### Пояснение:
- **`ip ospf authentication message-digest`** — включает аутентификацию MD5 на интерфейсе.
- **`ip ospf message-digest-key 1 md5 TEST`** — задает ключ с идентификатором `1` и значением `TEST`.
- **`no ip ospf passive`** — активирует OSPF на интерфейсе (если ранее был настроен `passive-interface`).

### Важные моменты:
1. **Совпадение ключей на обоих концах:**
   На обоих маршрутизаторах, которые устанавливают OSPF-соседство через `tun1`, должны быть настроены одинаковые ключи (key ID и значение ключа).

2. **Идентификатор ключа (key ID):**
   Key ID должен быть одинаковым на обоих концах. Например, если на одном маршрутизаторе используется `key ID 1`, то на другом тоже должен быть `key ID 1`.

3. **Тип аутентификации:**
   Убедитесь, что на обоих маршрутизаторах используется одинаковый тип аутентификации (`message-digest`).

### Проверка работы:
После настройки проверьте, установилось ли OSPF-соседство:

```bash
do show ip ospf neighbor
```

Если соседство установлено, аутентификация работает корректно. Если соседство не устанавливается, проверьте:
- Совпадение ключей и key ID на обоих концах.
- Правильность настройки интерфейсов.
- Отсутствие других проблем (например, недоступность туннеля).